<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Available Products</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

    <style>
        /* Profile and cart button styles */
        .fixed-buttons {
            position: fixed;
            right: 20px;
            top: 10px;
            z-index: 50;
            display: flex;
            gap: 10px;
            transition: opacity 0.3s ease;
        }

        /* Main container to align items */
        .main-container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding-top: 80px;
        }

        /* Container for products */
        .products-container {
            flex: 1;
            margin-right: 20px;
        }

        /* Container for header and buttons */
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            flex-wrap: wrap;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="header-container">
        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mt-3 w-full text-left">Available Products</h1>
        <!-- Fixed buttons for profile and cart -->
        <div class="fixed-buttons" id="fixedButtons">
            <a href="/profile" class="flex items-center bg-blue-600 text-white py-2 px-4 rounded-lg shadow-lg hover:bg-blue-700 transition duration-200">
                <img src="https://th.bing.com/th/id/OIP.v566qT_34jUiDSU7p5WD1gHaHa?rs=1&pid=ImgDetMain" alt="Profile" class="w-8 h-8 rounded-full mr-2" />
                <span>Profile</span>
            </a>
            <a href="/cart" class="flex items-center bg-blue-600 text-white py-2 px-4 rounded-lg shadow-lg hover:bg-blue-700 transition duration-200">
                <img src="https://th.bing.com/th/id/OIP.0B9qUkgn0IAUO6e2pP0pYQHaHa?rs=1&pid=ImgDetMain" alt="Cart" class="w-8 h-8 rounded-full mr-2" />
                <span>Your Cart</span>
            </a>
        </div>
    </div>

    <div class="container products-container mx-auto px-4 py-8">
        <div id="product-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <!-- Products will be dynamically loaded here -->
        </div>
    </div>

    <script>
        const fixedButtons = document.getElementById('fixedButtons');
        const productList = document.getElementById('product-list');

        // Example product data
        const products = [
            {
                _id: '1',
                imageUrl: 'https://th.bing.com/th/id/OIP.7SeMY3g9G_4NuDeEHBz8DgAAAA?rs=1&pid=ImgDetMain',
                name: 'Product 1',
                description: 'Description for Product 1',
                price: 29.99,
                stock: 10
            },
            {
                _id: '2',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 2',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '3',
                imageUrl: 'https://th.bing.com/th/id/OIP.iDV8mgDYQ1f-wHff6vsiLAHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 3',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '4',
                imageUrl: 'https://th.bing.com/th/id/OIP.TIWckpoCSJiDO_8U3qewegHaEh?rs=1&pid=ImgDetMain',
                name: 'Product 4',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '5',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 5',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },{
                _id: '6',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 6',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '7',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 7',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '8',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 8',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            },
            {
                _id: '9',
                imageUrl: 'https://th.bing.com/th/id/OIP.dtY1qot0pli5U2aQHALLtwHaHa?rs=1&pid=ImgDetMain',
                name: 'Product 9',
                description: 'Description for Product 2',
                price: 39.99,
                stock: 5
            }
           
        ];

        // Load products dynamically
        function loadProducts() {
            products.forEach(product => {
                const productCard = document.createElement('div');
                productCard.className = 'bg-white p-4 rounded-lg shadow-md flex items-center';
                productCard.innerHTML = `
                    <div class="flex-shrink-0 flex justify-center items-center">
                        <img src="${product.imageUrl}" alt="${product.name}" class="w-32 h-32 object-cover rounded">
                    </div>
                    <div class="ml-4 flex-1">
                        <h2 class="text-xl font-semibold">${product.name}</h2>
                        <p class="text-gray-600">${product.description}</p>
                        <p class="mt-2">Price: $${product.price.toFixed(2)}</p>
                        <p>Available Stock: ${product.stock}</p>
                        <div class="flex justify-between mt-4">
                            <button class="bg-blue-500 text-white rounded px-4 py-2 add-to-cart" data-product-id="${product._id}">Add to Cart</button>
                            <button class="bg-green-500 text-white rounded px-4 py-2 buy-now" data-product-id="${product._id}">Buy Now</button>
                        </div>
                    </div>
                `;
                productList.appendChild(productCard);
            });
        }

        // Hide the buttons on scroll
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                fixedButtons.style.opacity = '0';
            } else {
                fixedButtons.style.opacity = '1';
            }
        });

        // Add to cart functionality
        document.addEventListener('click', async (event) => {
            if (event.target.classList.contains('add-to-cart')) {
                const productId = event.target.dataset.productId;
                try {
                    const response = await fetch('/cart/add', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ productId, quantity: 1 })
                    });

                    const result = await response.json();
                    if (response.ok) {
                        alert(result.message || 'Product added to cart!');
                    } else {
                        alert(result.error || 'Failed to add product to cart.');
                    }
                } catch (error) {
                    console.error('Error adding product to cart:', error);
                    alert('An error occurred. Please try again.');
                }
            }
        });

        // Buy now functionality
        document.addEventListener('click', (event) => {
            if (event.target.classList.contains('buy-now')) {
                const productId = event.target.dataset.productId;
                window.location.href = `/checkout/${productId}?quantity=1`;
            }
        });

        // Load products when the page loads
        window.onload = loadProducts;
    </script>
</body>
</html>
